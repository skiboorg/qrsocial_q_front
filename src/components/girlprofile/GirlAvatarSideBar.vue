<template>
  <div class="wall-avatar">
			<div class="avatar-block backblock">
        <q-avatar size="185px" class="q-mb-md">
          <img :src="currentGirl.avatar" alt="avatar">
        </q-avatar>

				<div class="settings-profile cursor-pointer" @click="friendAction(currentGirl.nickname)">
					<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M18.1 8.3H17.2V7.4C17.2 7.16131 17.1052 6.93239 16.9364 6.7636C16.7676 6.59482 16.5387 6.5 16.3 6.5C16.0613 6.5 15.8324 6.59482 15.6636 6.7636C15.4948 6.93239 15.4 7.16131 15.4 7.4V8.3H14.5C14.2613 8.3 14.0324 8.39482 13.8636 8.5636C13.6948 8.73239 13.6 8.96131 13.6 9.2C13.6 9.4387 13.6948 9.66761 13.8636 9.8364C14.0324 10.0052 14.2613 10.1 14.5 10.1H15.4V11C15.4 11.2387 15.4948 11.4676 15.6636 11.6364C15.8324 11.8052 16.0613 11.9 16.3 11.9C16.5387 11.9 16.7676 11.8052 16.9364 11.6364C17.1052 11.4676 17.2 11.2387 17.2 11V10.1H18.1C18.3387 10.1 18.5676 10.0052 18.7364 9.8364C18.9052 9.66761 19 9.4387 19 9.2C19 8.96131 18.9052 8.73239 18.7364 8.5636C18.5676 8.39482 18.3387 8.3 18.1 8.3ZM11.17 9.848C11.6502 9.43232 12.0354 8.9182 12.2994 8.34052C12.5634 7.76285 12.7 7.13514 12.7 6.5C12.7 5.30653 12.2259 4.16193 11.382 3.31802C10.5381 2.47411 9.39347 2 8.2 2C7.00653 2 5.86193 2.47411 5.01802 3.31802C4.17411 4.16193 3.7 5.30653 3.7 6.5C3.69999 7.13514 3.83662 7.76285 4.10061 8.34052C4.3646 8.9182 4.74978 9.43232 5.23 9.848C3.97013 10.4185 2.90122 11.3398 2.15108 12.5017C1.40095 13.6636 1.00132 15.017 1 16.4C1 16.6387 1.09482 16.8676 1.2636 17.0364C1.43239 17.2052 1.66131 17.3 1.9 17.3C2.13869 17.3 2.36761 17.2052 2.5364 17.0364C2.70518 16.8676 2.8 16.6387 2.8 16.4C2.8 14.9678 3.36893 13.5943 4.38162 12.5816C5.39432 11.5689 6.76783 11 8.2 11C9.63217 11 11.0057 11.5689 12.0184 12.5816C13.0311 13.5943 13.6 14.9678 13.6 16.4C13.6 16.6387 13.6948 16.8676 13.8636 17.0364C14.0324 17.2052 14.2613 17.3 14.5 17.3C14.7387 17.3 14.9676 17.2052 15.1364 17.0364C15.3052 16.8676 15.4 16.6387 15.4 16.4C15.3987 15.017 14.9991 13.6636 14.2489 12.5017C13.4988 11.3398 12.4299 10.4185 11.17 9.848ZM8.2 9.2C7.66599 9.2 7.14397 9.04165 6.69996 8.74497C6.25595 8.44829 5.90988 8.02661 5.70553 7.53325C5.50117 7.03989 5.4477 6.49701 5.55188 5.97326C5.65606 5.44951 5.91321 4.96841 6.29081 4.59081C6.66841 4.21321 7.14951 3.95606 7.67326 3.85188C8.197 3.7477 8.73988 3.80117 9.23324 4.00553C9.72661 4.20988 10.1483 4.55595 10.445 4.99996C10.7416 5.44397 10.9 5.96599 10.9 6.5C10.9 7.21608 10.6155 7.90284 10.1092 8.40919C9.60284 8.91554 8.91608 9.2 8.2 9.2Z" fill="#4D94FF"></path>
					</svg>
					 <span class="inline-block q-ml-sm">订阅</span>
				</div>
				<div class="settings-profile cursor-pointer" @click="$router.push({name:'user-profile-chat',params:{nickname:currentGirl.nickname}})" >
					<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M9.99988 7.29991C9.82187 7.29991 9.64787 7.3527 9.49987 7.45159C9.35187 7.55048 9.23651 7.69104 9.1684 7.85549C9.10028 8.01994 9.08245 8.2009 9.11718 8.37548C9.15191 8.55006 9.23762 8.71042 9.36349 8.83629C9.48935 8.96215 9.64972 9.04787 9.8243 9.08259C9.99888 9.11732 10.1798 9.0995 10.3443 9.03138C10.5087 8.96326 10.6493 8.84791 10.7482 8.69991C10.8471 8.5519 10.8999 8.3779 10.8999 8.1999C10.8999 7.96121 10.805 7.73229 10.6363 7.56351C10.4675 7.39473 10.2386 7.29991 9.99988 7.29991ZM16.2998 1H3.69996C2.98389 1 2.29714 1.28446 1.7908 1.7908C1.28446 2.29714 1 2.98389 1 3.69996V12.6998C1 13.4159 1.28446 14.1027 1.7908 14.609C2.29714 15.1153 2.98389 15.3998 3.69996 15.3998H14.1308L17.4608 18.7388C17.5449 18.8222 17.6446 18.8882 17.7543 18.9329C17.8639 18.9777 17.9813 19.0004 18.0998 18.9997C18.2178 19.0028 18.3349 18.9781 18.4418 18.9277C18.6061 18.8602 18.7468 18.7456 18.8461 18.5982C18.9454 18.4509 18.9989 18.2774 18.9998 18.0998V3.69996C18.9998 2.98389 18.7153 2.29714 18.209 1.7908C17.7026 1.28446 17.0159 1 16.2998 1ZM17.1998 15.9308L15.1388 13.8608C15.0547 13.7774 14.955 13.7114 14.8453 13.6666C14.7357 13.6218 14.6183 13.5991 14.4998 13.5998H3.69996C3.46127 13.5998 3.23236 13.505 3.06358 13.3362C2.8948 13.1674 2.79998 12.9385 2.79998 12.6998V3.69996C2.79998 3.46127 2.8948 3.23236 3.06358 3.06358C3.23236 2.89479 3.46127 2.79997 3.69996 2.79997H16.2998C16.5385 2.79997 16.7674 2.89479 16.9362 3.06358C17.105 3.23236 17.1998 3.46127 17.1998 3.69996V15.9308ZM6.39993 7.29991C6.22192 7.29991 6.04792 7.3527 5.89992 7.45159C5.75192 7.55048 5.63656 7.69104 5.56845 7.85549C5.50033 8.01994 5.4825 8.2009 5.51723 8.37548C5.55196 8.55006 5.63767 8.71042 5.76354 8.83629C5.8894 8.96215 6.04977 9.04787 6.22435 9.08259C6.39893 9.11732 6.57988 9.0995 6.74434 9.03138C6.90879 8.96326 7.04935 8.84791 7.14824 8.69991C7.24713 8.5519 7.29991 8.3779 7.29991 8.1999C7.29991 7.96121 7.20509 7.73229 7.03631 7.56351C6.86753 7.39473 6.63862 7.29991 6.39993 7.29991ZM13.5998 7.29991C13.4218 7.29991 13.2478 7.3527 13.0998 7.45159C12.9518 7.55048 12.8365 7.69104 12.7683 7.85549C12.7002 8.01994 12.6824 8.2009 12.7171 8.37548C12.7519 8.55006 12.8376 8.71042 12.9634 8.83629C13.0893 8.96215 13.2497 9.04787 13.4242 9.08259C13.5988 9.11732 13.7798 9.0995 13.9442 9.03138C14.1087 8.96326 14.2492 8.84791 14.3481 8.69991C14.447 8.5519 14.4998 8.3779 14.4998 8.1999C14.4998 7.96121 14.405 7.73229 14.2362 7.56351C14.0674 7.39473 13.8385 7.29991 13.5998 7.29991Z" fill="#4D94FF"></path>
					</svg>
					 <span class="inline-block q-ml-sm">聊天室</span>
				</div>
				<div class="settings-profile cursor-pointer" @click="setGiftModal(true)">
					<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M17.6154 5.79473H14.5894C15.04 5.2122 15.2619 4.46838 15.2093 3.71725C15.1567 2.96611 14.8335 2.26518 14.3067 1.75954C13.7799 1.2539 13.0898 0.982279 12.3792 1.0009C11.6686 1.01952 10.992 1.32695 10.4895 1.85956C10.289 2.08094 10.1237 2.33526 10 2.61263C9.87622 2.33527 9.7109 2.08096 9.51045 1.85956C9.00783 1.32716 8.33128 1.01992 7.62083 1.0014C6.91037 0.982876 6.22039 1.2545 5.69367 1.76007C5.16695 2.26563 4.84381 2.96643 4.79112 3.71744C4.73843 4.46846 4.96023 5.21219 5.41061 5.79473H2.38462C2.01752 5.79517 1.66558 5.94989 1.406 6.22496C1.14642 6.50003 1.00041 6.87298 1 7.26198V10.1965C1.00041 10.5855 1.14642 10.9584 1.406 11.2335C1.66558 11.5086 2.01752 11.6633 2.38462 11.6637V17.5327C2.38503 17.9218 2.53104 18.2947 2.79062 18.5698C3.05019 18.8448 3.40213 18.9996 3.76923 19H16.2308C16.5979 18.9996 16.9498 18.8448 17.2094 18.5698C17.469 18.2947 17.615 17.9218 17.6154 17.5327V11.6637C17.9825 11.6633 18.3344 11.5086 18.594 11.2335C18.8536 10.9584 18.9996 10.5855 19 10.1965V7.26198C18.9996 6.87298 18.8536 6.50003 18.594 6.22496C18.3344 5.94989 17.9825 5.79517 17.6154 5.79473ZM11.4686 2.89709C11.7282 2.62192 12.0804 2.46733 12.4477 2.46733C12.8149 2.46733 13.1671 2.62192 13.4268 2.89709C13.6864 3.17226 13.8323 3.54547 13.8323 3.93462C13.8323 4.32377 13.6864 4.69698 13.4268 4.97215C12.9993 5.42517 11.763 5.67964 10.7218 5.76346C10.8009 4.66009 11.041 3.3502 11.4686 2.89709ZM6.57316 2.89709C6.83306 2.62236 7.18516 2.46807 7.55226 2.46807C7.91935 2.46807 8.27146 2.62236 8.53136 2.89709C8.95903 3.3502 9.19909 4.66018 9.27818 5.76346C8.23695 5.67964 7.00084 5.42517 6.57325 4.97206C6.31402 4.69666 6.16844 4.32356 6.16844 3.93458C6.16844 3.54559 6.31402 3.17249 6.57325 2.89709H6.57316ZM2.38462 7.26198H9.30769V10.1965H2.38462V7.26198ZM3.76923 11.6637H9.30769V17.5327H3.76923V11.6637ZM16.2308 17.5327H10.6923V11.6637H16.2308V17.5327ZM17.6154 10.1965H10.6923V7.26198H17.6154L17.6162 10.1965H17.6154Z" fill="#4D94FF"></path>
					</svg>
					 <span class="inline-block q-ml-sm">礼物</span>
				</div>
			</div>
			<div class="favorite-block backblock womanwall">
				<div class="text-body2 q-mb-md text-bold text-grey-6">前 3 名粉丝</div>
				<div class="top-three">
					<div class="one" v-for="(user,index) in top_donaters " :key="index">

						<div class="one-people">
							<img class="one-king" :src="`${index}.svg`" alt="one">
              <q-avatar size="42px" class="one-avatar">
                <img  :src="user.from_user.avatar" alt="one">
              </q-avatar>

						</div>
						<div class="info">

							<div style="max-width: 100px" class="name "><p class="no-margin text-bold ellipsis">{{user.from_user.fio}}</p></div>
							<div style="max-width: 100px" class="name "><p class="no-margin ellipsis text-caption">@{{user.from_user.nickname}}</p></div>
						</div>
					</div >

				</div>

			</div>
		</div>
  <GiftModal/>
</template>

<script>

import {mapGetters, mapActions} from 'vuex'
import {Notify} from "quasar";

import GiftModal from 'components/GiftModal.vue'
export default {
components:{GiftModal},
  data () {
    return {
      top_donaters:[],

    }
  },
  async beforeMount() {
    const response = await this.$api.get(`/api/v1/gift/get_user_top3_donaters?nickname=${this.currentGirl.nickname}`)
    this.top_donaters = response.data
  },
  methods:{
    ...mapActions('auth',['getUser',]),
    ...mapActions('data',['setGiftModal']),
    async sendBlankChatMessage(nickname){
      await this.$api.post('/api/v1/chat/new_message',{nickname:this.currentGirl.nickname,message:'hello'})
      console.log('message send')
      //this.$auth.user.is_streamer ?  this.$router.push( `/streamer/chats#${nickname}`) : this.$router.push( `/lk/chats#${nickname}`)
    },
    async friendAction(nickname){
      let checkFriendList = this.$auth.user.own_friend_list[0].friend_list.filter(x => x.nickname === nickname)
      console.log(checkFriendList)
      if (checkFriendList.length > 0){
        await this.$api.post('/api/v1/friend/add_or_delete_friend_by_nickname',{nickname:nickname,action:'delete'})
        Notify.create(
            {
              message: '该用户已从您的书签中删除',
              position:'top-right',
              color: 'red'
            }
          )
      }else {
        await this.$api.post('/api/v1/friend/add_or_delete_friend_by_nickname',{nickname:nickname,action:'add'})
        Notify.create(
            {
              message: '书签中的用户',
              position:'top-right',
              color: 'positive'
            }
          )
      }
      await this.getUser()
    }
  },
  computed:{
    ...mapGetters('data',['currentGirl']),

  }
}
</script>
 <style lang="sass">

 </style>
